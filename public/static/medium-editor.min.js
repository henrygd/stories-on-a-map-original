"classList"in document.createElement("_")||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],o=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},r=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},l=function(t,e){if(""===e)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(t,e)},c=function(t){for(var e=s.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,o=n.length;o>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},h=c[n]=[],u=function(){return new c(this)};if(r[n]=Error[n],h.item=function(t){return this[t]||null},h.contains=function(t){return t+="",-1!==l(this,t)},h.add=function(){var t,e=arguments,n=0,i=e.length,o=!1;do t=e[n]+"",-1===l(this,t)&&(this.push(t),o=!0);while(++n<i);o&&this._updateClassName()},h.remove=function(){var t,e,n=arguments,i=0,o=n.length,s=!1;do for(t=n[i]+"",e=l(this,t);-1!==e;)this.splice(e,1),s=!0,e=l(this,t);while(++i<o);s&&this._updateClassName()},h.toggle=function(t,e){t+="";var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},h.toString=function(){return this.join(" ")},o.defineProperty){var d={get:u,enumerable:!0,configurable:!0};try{o.defineProperty(i,e,d)}catch(p){-2146823252===p.number&&(d.enumerable=!1,o.defineProperty(i,e,d))}}else o[n].__defineGetter__&&i.__defineGetter__(e,u)}}(self),function(t){"use strict";if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL)try{return void new Blob}catch(e){}var n=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},i=function(t,e,n){this.data=t,this.size=t.length,this.type=e,this.encoding=n},o=n.prototype,s=i.prototype,a=t.FileReaderSync,r=function(t){this.code=this[this.name=t]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,h=t.URL||t.webkitURL||t,u=h.createObjectURL,d=h.revokeObjectURL,p=h,f=t.btoa,m=t.atob,b=t.ArrayBuffer,g=t.Uint8Array,v=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(i.fake=s.fake=!0;c--;)r.prototype[l[c]]=c+1;return h.createObjectURL||(p=t.URL=function(t){var e,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=t,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(e=t.match(v),n.origin=e&&e[1])),n}),p.createObjectURL=function(t){var e,n=t.type;return null===n&&(n="application/octet-stream"),t instanceof i?(e="data:"+n,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):f?e+";base64,"+f(t.data):e+","+encodeURIComponent(t.data)):u?u.call(h,t):void 0},p.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&d&&d.call(h,t)},o.append=function(t){var n=this.data;if(g&&(t instanceof b||t instanceof g)){for(var o="",s=new g(t),l=0,c=s.length;c>l;l++)o+=String.fromCharCode(s[l]);n.push(o)}else if("Blob"===e(t)||"File"===e(t)){if(!a)throw new r("NOT_READABLE_ERR");var h=new a;n.push(h.readAsBinaryString(t))}else t instanceof i?"base64"===t.encoding&&m?n.push(m(t.data)):"URI"===t.encoding?n.push(decodeURIComponent(t.data)):"raw"===t.encoding&&n.push(t.data):("string"!=typeof t&&(t+=""),n.push(unescape(encodeURIComponent(t))))},o.getBlob=function(t){return arguments.length||(t=null),new i(this.data.join(""),t,"raw")},o.toString=function(){return"[object BlobBuilder]"},s.slice=function(t,e,n){var o=arguments.length;return 3>o&&(n=null),new i(this.data.slice(t,o>1?e:this.data.length),n,this.encoding)},s.toString=function(){return"[object Blob]"},s.close=function(){this.size=0,delete this.data},n}(t);t.Blob=function(t,e){var i=e?e.type||"":"",o=new n;if(t)for(var s=0,a=t.length;a>s;s++)Uint8Array&&t[s]instanceof Uint8Array?o.append(t[s].buffer):o.append(t[s]);var r=o.getBlob(i);return!r.slice&&r.webkitSlice&&(r.slice=r.webkitSlice),r};var i=Object.getPrototypeOf||function(t){return t.__proto__};t.Blob.prototype=i(new t.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(t,e){"use strict";"object"==typeof module?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):t.MediumEditor=e}(this,function(){"use strict";function t(t,e){return this.init(t,e)}var e;!function(t){function n(e,n,i){i||(i=t);try{for(var o=0;o<e.length;o++){var s=e[o];if(!(s in i)){if(!n)return;i[s]={}}i=i[s]}return i}catch(a){}}function i(t,e){var n,i=Array.prototype.slice.call(arguments,2);e=e||{};for(var o=0;o<i.length;o++){var s=i[o];if(s)for(n in s)s.hasOwnProperty(n)&&"undefined"!=typeof s[n]&&(t||e.hasOwnProperty(n)===!1)&&(e[n]=s[n])}return e}e={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46},parentElements:["p","h1","h2","h3","h4","h5","h6","blockquote","pre"],extend:function(){var t=[!0].concat(Array.prototype.slice.call(arguments));return i.apply(this,t)},defaults:function(){var t=[!1].concat(Array.prototype.slice.call(arguments));return i.apply(this,t)},derives:function(t,e){function n(){}var o=e.prototype;return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=t,e.prototype=i(!1,e.prototype,o),e},findAdjacentTextNodeWithContent:function(t,e,n){var i,o=!1,s=n.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);for(i=s.nextNode();i;){if(i===e)o=!0;else if(o&&3===i.nodeType&&i.nodeValue&&i.nodeValue.trim().length>0)break;i=s.nextNode()}return i},isDescendant:function(t,e,n){if(!t||!e)return!1;if(n&&t===e)return!0;for(var i=e.parentNode;null!==i;){if(i===t)return!0;i=i.parentNode}return!1},isElement:function(t){return!(!t||1!==t.nodeType)},now:Date.now,throttle:function(t,e){var n,i,o,s=50,a=null,r=0,l=function(){r=Date.now(),a=null,o=t.apply(n,i),a||(n=i=null)};return e||0===e||(e=s),function(){var s=Date.now(),c=e-(s-r);return n=this,i=arguments,0>=c||c>e?(a&&(clearTimeout(a),a=null),r=s,o=t.apply(n,i),a||(n=i=null)):a||(a=setTimeout(l,c)),o}},traverseUp:function(t,e){if(!t)return!1;do{if(1===t.nodeType){if(e(t))return t;if(t.getAttribute("data-medium-element"))return!1}t=t.parentNode}while(t);return!1},htmlEntities:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(t,e){var n,i,o,s,a,r,l;if(t.queryCommandSupported("insertHTML"))try{return t.execCommand("insertHTML",!1,e)}catch(c){}if(n=t.defaultView.getSelection(),n.getRangeAt&&n.rangeCount){if(i=n.getRangeAt(0),l=i.commonAncestorContainer,3===l.nodeType&&l.nodeValue===i.toString()||3!==l.nodeType&&l.innerHTML===i.toString()){for(;l.parentNode&&1===l.parentNode.childNodes.length&&!l.parentNode.getAttribute("data-medium-element");)l=l.parentNode;i.selectNode(l)}for(i.deleteContents(),o=t.createElement("div"),o.innerHTML=e,s=t.createDocumentFragment();o.firstChild;)a=o.firstChild,r=s.appendChild(a);i.insertNode(s),r&&(i=i.cloneRange(),i.setStartAfter(r),i.collapse(!0),n.removeAllRanges(),n.addRange(i))}},getSelectionRange:function(t){var e=t.getSelection();return 0===e.rangeCount?null:e.getRangeAt(0)},getSelectionStart:function(t){var e=t.getSelection().anchorNode,n=e&&3===e.nodeType?e.parentNode:e;return n},getSelectionData:function(t){var e;for(t&&t.tagName&&(e=t.tagName.toLowerCase());t&&-1===this.parentElements.indexOf(e);)t=t.parentNode,t&&t.tagName&&(e=t.tagName.toLowerCase());return{el:t,tagName:e}},execFormatBlock:function(t,e){var n=this.getSelectionData(this.getSelectionStart(t));if("blockquote"===e&&n.el&&"blockquote"===n.el.parentNode.tagName.toLowerCase())return t.execCommand("outdent",!1,null);if(n.tagName===e&&(e="p"),this.isIE){if("blockquote"===e)return t.execCommand("indent",!1,e);e="<"+e+">"}return t.execCommand("formatBlock",!1,e)},setTargetBlank:function(t){var e;if("a"===t.tagName.toLowerCase())t.target="_blank";else for(t=t.getElementsByTagName("a"),e=0;e<t.length;e+=1)t[e].target="_blank"},addClassToAnchors:function(t,e){var n,i,o=e.split(" ");if("a"===t.tagName.toLowerCase())for(i=0;i<o.length;i+=1)t.classList.add(o[i]);else for(t=t.getElementsByTagName("a"),n=0;n<t.length;n+=1)for(i=0;i<o.length;i+=1)t[n].classList.add(o[i])},isListItem:function(t){if(!t)return!1;if("li"===t.tagName.toLowerCase())return!0;for(var e=t.parentNode,n=e.tagName.toLowerCase();-1===this.parentElements.indexOf(n)&&"div"!==n;){if("li"===n)return!0;if(e=e.parentNode,!e||!e.tagName)return!1;n=e.tagName.toLowerCase()}return!1},cleanListDOM:function(t){if("li"===t.tagName.toLowerCase()){var e=t.parentElement;"p"===e.parentElement.tagName.toLowerCase()&&this.unwrapElement(e.parentElement)}},unwrapElement:function(t){var e,n=t.parentNode,i=t.firstChild;do e=i.nextSibling,n.insertBefore(i,t),i=e;while(i);n.removeChild(t)},warn:function(){void 0!==t.console&&"function"==typeof t.console.warn&&t.console.warn.apply(console,arguments)},deprecated:function(t,n,i){var o=t+" is deprecated, please use "+n+" instead.";i&&(o+=" Will be removed in "+i),e.warn(o)},deprecatedMethod:function(t,n,i,o){e.deprecated(t,n,o),"function"==typeof this[n]&&this[n].apply(this,i)},cleanupAttrs:function(t,e){e.forEach(function(e){t.removeAttribute(e)})},cleanupTags:function(t,e){e.forEach(function(e){t.tagName.toLowerCase()===e&&t.parentNode.removeChild(t)},this)},getClosestTag:function(t,n){return e.traverseUp(t,function(t){return t.tagName.toLowerCase()===n.toLowerCase()})},unwrap:function(t,e){for(var n=e.createDocumentFragment(),i=Array.prototype.slice.call(t.childNodes),o=0;o<i.length;o++)n.appendChild(i[o]);n.childNodes.length?t.parentNode.replaceChild(n,t):t.parentNode.removeChild(t)},setObject:function(t,e,i){var o=t.split("."),s=o.pop(),a=n(o,!0,i);return a&&s?a[s]=e:void 0},getObject:function(t,e,i){return n(t?t.split("."):[],e,i)}}}(window);var n;!function(){n={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>',key:"b"},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>',key:"i"},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>',key:"u"},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},header1:{name:"header1",action:function(t){return"append-"+t.firstHeader},aria:function(t){return t.firstHeader},tagNames:function(t){return[t.firstHeader]},contentDefault:"<b>H1</b>"},header2:{name:"header2",action:function(t){return"append-"+t.secondHeader},aria:function(t){return t.secondHeader},tagNames:function(t){return[t.secondHeader]},contentDefault:"<b>H2</b>"},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'}}}();var i;!function(){i={allowMultiParagraphSelection:!0,anchorInputPlaceholder:"Paste or type a link",anchorInputCheckboxLabel:"Open in new window",anchorPreviewHideDelay:500,buttons:["bold","italic","underline","anchor","header1","header2","quote"],buttonLabels:!1,checkLinkFormat:!1,delay:0,diffLeft:0,diffTop:-10,disableReturn:!1,disableDoubleReturn:!1,disableToolbar:!1,disableAnchorPreview:!1,disableEditing:!1,disablePlaceholders:!1,toolbarAlign:"center",elementsContainer:!1,imageDragging:!0,standardizeSelectionStart:!1,contentWindow:window,ownerDocument:document,firstHeader:"h3",placeholder:"Type your text",secondHeader:"h4",targetBlank:!1,anchorTarget:!1,anchorButton:!1,anchorButtonClass:"btn",extensions:{},activeButtonClass:"medium-editor-button-active",firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",spellcheck:!0,paste:{forcePlainText:!0,cleanPastedHTML:!1,cleanAttrs:["class","style","dir"],cleanTags:["meta"]}}}();var o;!function(){o=function(t){e.extend(this,t)},o.extend=function(t){var n,i=this;n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)},e.extend(n,i);var o=function(){this.constructor=n};return o.prototype=i.prototype,n.prototype=new o,t&&e.extend(n.prototype,t),n},o.prototype={init:function(){},parent:!1,base:null,name:null,checkState:null,getButton:null,queryCommandState:null,isActive:null,isAlreadyApplied:null,setActive:null,setInactive:null,onHide:null}}();var s;!function(){s={findMatchingSelectionParent:function(t,n){var i,o,s=n.getSelection();return 0===s.rangeCount?!1:(i=s.getRangeAt(0),o=i.commonAncestorContainer,e.traverseUp(o,t))},getSelectionElement:function(t){return this.findMatchingSelectionParent(function(t){return t.getAttribute("data-medium-element")},t)},selectionInContentEditableFalse:function(t){return this.findMatchingSelectionParent(function(t){return t&&"#text"!==t.nodeName&&"false"===t.getAttribute("contenteditable")},t)},getSelectionHtml:function(){var t,e,n,i="",o=this.options.contentWindow.getSelection();if(o.rangeCount){for(n=this.options.ownerDocument.createElement("div"),t=0,e=o.rangeCount;e>t;t+=1)n.appendChild(o.getRangeAt(t).cloneContents());i=n.innerHTML}return i},getCaretOffsets:function(t,e){var n,i;return e||(e=window.getSelection().getRangeAt(0)),n=e.cloneRange(),i=e.cloneRange(),n.selectNodeContents(t),n.setEnd(e.endContainer,e.endOffset),i.selectNodeContents(t),i.setStart(e.endContainer,e.endOffset),{left:n.toString().length,right:i.toString().length}},rangeSelectsSingleNode:function(t){var e=t.startContainer;return e===t.endContainer&&e.hasChildNodes()&&t.endOffset===t.startOffset+1},getSelectedParentElement:function(t){var e=null;return e=this.rangeSelectsSingleNode(t)&&3!==t.startContainer.childNodes[t.startOffset].nodeType?t.startContainer.childNodes[t.startOffset]:3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer},getSelectedElements:function(t){var e,n,i,o=t.getSelection();if(!o.rangeCount||!o.getRangeAt(0).commonAncestorContainer)return[];if(e=o.getRangeAt(0),3===e.commonAncestorContainer.nodeType){for(n=[],i=e.commonAncestorContainer;i.parentNode&&1===i.parentNode.childNodes.length;)n.push(i.parentNode),i=i.parentNode;return n}return[].filter.call(e.commonAncestorContainer.getElementsByTagName("*"),function(t){return"function"==typeof o.containsNode?o.containsNode(t,!0):!0})},selectNode:function(t,e){var n=e.createRange(),i=e.getSelection();n.selectNodeContents(t),i.removeAllRanges(),i.addRange(n)}}}();var a;!function(){a=function(t){this.base=t,this.options=this.base.options,this.events=[],this.customEvents={},this.listeners={}},a.prototype={attachDOMEvent:function(t,e,n,i){t.addEventListener(e,n,i),this.events.push([t,e,n,i])},detachDOMEvent:function(t,e,n,i){var o,s=this.indexOfListener(t,e,n,i);-1!==s&&(o=this.events.splice(s,1)[0],o[0].removeEventListener(o[1],o[2],o[3]))},indexOfListener:function(t,e,n,i){var o,s,a;for(o=0,s=this.events.length;s>o;o+=1)if(a=this.events[o],a[0]===t&&a[1]===e&&a[2]===n&&a[3]===i)return o;return-1},detachAllDOMEvents:function(){for(var t=this.events.pop();t;)t[0].removeEventListener(t[1],t[2],t[3]),t=this.events.pop()},attachCustomEvent:function(t,e){this.setupListener(t),this.listeners[t]&&(this.customEvents[t]||(this.customEvents[t]=[]),this.customEvents[t].push(e))},detachCustomEvent:function(t,e){var n=this.indexOfCustomListener(t,e);-1!==n&&this.customEvents[t].splice(n,1)},indexOfCustomListener:function(t,e){return this.customEvents[t]&&this.customEvents[t].length?this.customEvents[t].indexOf(e):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(t,e,n){this.customEvents[t]&&this.customEvents[t].forEach(function(t){t(e,n)})},setupListener:function(t){if(!this.listeners[t])switch(t){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0),this.listeners[t]=!0;break;case"blur":this.setupListener("externalInteraction"),this.listeners[t]=!0;break;case"focus":this.setupListener("externalInteraction"),this.listeners[t]=!0;break;case"editableClick":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"click",this.handleClick.bind(this))}.bind(this)),this.listeners[t]=!0;break;case"editableBlur":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"blur",this.handleBlur.bind(this))}.bind(this)),this.listeners[t]=!0;break;case"editableKeypress":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"keypress",this.handleKeypress.bind(this))}.bind(this)),this.listeners[t]=!0;break;case"editableKeyup":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"keyup",this.handleKeyup.bind(this))}.bind(this)),this.listeners[t]=!0;break;case"editableKeydown":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"keydown",this.handleKeydown.bind(this))}.bind(this)),this.listeners[t]=!0;break;case"editableKeydownEnter":this.setupListener("editableKeydown"),this.listeners[t]=!0;break;case"editableKeydownTab":this.setupListener("editableKeydown"),this.listeners[t]=!0;break;case"editableKeydownDelete":this.setupListener("editableKeydown"),this.listeners[t]=!0;break;case"editableMouseover":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"mouseover",this.handleMouseover.bind(this))},this),this.listeners[t]=!0;break;case"editableDrag":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"dragover",this.handleDragging.bind(this)),this.attachDOMEvent(t,"dragleave",this.handleDragging.bind(this))},this),this.listeners[t]=!0;break;case"editableDrop":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"drop",this.handleDrop.bind(this))},this),this.listeners[t]=!0;break;case"editablePaste":this.base.elements.forEach(function(t){this.attachDOMEvent(t,"paste",this.handlePaste.bind(this))},this),this.listeners[t]=!0}},focusElement:function(t){t.focus(),this.updateFocus(t,{target:t,type:"focus"})},updateFocus:function(t,n){var i,o,s=this.base.toolbar?this.base.toolbar.getToolbarElement():null,a=this.base.getExtensionByName("anchor-preview"),r=a&&a.getPreviewElement?a.getPreviewElement():null;this.base.elements.some(function(t){return!i&&t.getAttribute("data-medium-focused")&&(i=t),!!i},this),i&&"click"===n.type&&this.lastMousedownTarget&&(e.isDescendant(i,this.lastMousedownTarget,!0)||e.isDescendant(s,this.lastMousedownTarget,!0)||e.isDescendant(r,this.lastMousedownTarget,!0))&&(o=i),o||this.base.elements.some(function(n){return!o&&e.isDescendant(n,t,!0)&&(o=n),!!o},this);var l=!e.isDescendant(i,t,!0)&&!e.isDescendant(s,t,!0)&&!e.isDescendant(r,t,!0);o!==i&&(i&&l&&(i.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",n,i)),o&&(o.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",n,o))),l&&this.triggerCustomEvent("externalInteraction",n)},handleBodyClick:function(t){this.updateFocus(t.target,t)},handleBodyFocus:function(t){this.updateFocus(t.target,t)},handleBodyMousedown:function(t){this.lastMousedownTarget=t.target},handleClick:function(t){this.triggerCustomEvent("editableClick",t,t.currentTarget)},handleBlur:function(t){this.triggerCustomEvent("editableBlur",t,t.currentTarget)},handleKeypress:function(t){this.triggerCustomEvent("editableKeypress",t,t.currentTarget)},handleKeyup:function(t){this.triggerCustomEvent("editableKeyup",t,t.currentTarget)},handleMouseover:function(t){this.triggerCustomEvent("editableMouseover",t,t.currentTarget)},handleDragging:function(t){this.triggerCustomEvent("editableDrag",t,t.currentTarget)},handleDrop:function(t){this.triggerCustomEvent("editableDrop",t,t.currentTarget)},handlePaste:function(t){this.triggerCustomEvent("editablePaste",t,t.currentTarget)},handleKeydown:function(t){switch(this.triggerCustomEvent("editableKeydown",t,t.currentTarget),t.which){case e.keyCode.ENTER:this.triggerCustomEvent("editableKeydownEnter",t,t.currentTarget);break;case e.keyCode.TAB:this.triggerCustomEvent("editableKeydownTab",t,t.currentTarget);break;case e.keyCode.DELETE:case e.keyCode.BACKSPACE:this.triggerCustomEvent("editableKeydownDelete",t,t.currentTarget)}}}}();var r;!function(){r=function(t,e){this.options=t,this.name=t.name,this.init(e)},r.prototype={init:function(t){this.base=t,this.button=this.createButton(),this.base.on(this.button,"click",this.handleClick.bind(this)),this.options.key&&this.base.subscribe("editableKeydown",this.handleKeydown.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.options.action?this.options.action(this.base.options):this.options.action},getAria:function(){return"function"==typeof this.options.aria?this.options.aria(this.base.options):this.options.aria},getTagNames:function(){return"function"==typeof this.options.tagNames?this.options.tagNames(this.base.options):this.options.tagNames},createButton:function(){var t=this.base.options.ownerDocument.createElement("button"),e=this.options.contentDefault,n=this.getAria();return t.classList.add("medium-editor-action"),t.classList.add("medium-editor-action-"+this.name),t.setAttribute("data-action",this.getAction()),n&&(t.setAttribute("title",n),t.setAttribute("aria-label",n)),this.base.options.buttonLabels&&("fontawesome"===this.base.options.buttonLabels&&this.options.contentFA?e=this.options.contentFA:"object"==typeof this.base.options.buttonLabels&&this.base.options.buttonLabels[this.name]&&(e=this.base.options.buttonLabels[this.options.name])),t.innerHTML=e,t},handleKeydown:function(t){var e,n;(t.ctrlKey||t.metaKey)&&(e=String.fromCharCode(t.which||t.keyCode).toLowerCase(),this.options.key===e&&(t.preventDefault(),t.stopPropagation(),n=this.getAction(),n&&this.base.execAction(n)))},handleClick:function(t){t.preventDefault(),t.stopPropagation();var e=this.getAction();e&&this.base.execAction(e)},isActive:function(){return this.button.classList.contains(this.base.options.activeButtonClass)},setInactive:function(){this.button.classList.remove(this.base.options.activeButtonClass),delete this.knownState},setActive:function(){this.button.classList.add(this.base.options.activeButtonClass),delete this.knownState},queryCommandState:function(){var t=null;return this.options.useQueryState&&(t=this.base.queryCommandState(this.getAction())),t},isAlreadyApplied:function(t){var e,n,i=!1,o=this.getTagNames();return this.knownState===!1||this.knownState===!0?this.knownState:(o&&o.length>0&&t.tagName&&(i=-1!==o.indexOf(t.tagName.toLowerCase())),!i&&this.options.style&&(e=this.options.style.value.split("|"),n=this.base.options.contentWindow.getComputedStyle(t,null).getPropertyValue(this.options.style.prop),e.forEach(function(t){this.knownState||(i=-1!==n.indexOf(t),(i||"text-decoration"!==this.options.style.prop)&&(this.knownState=i))},this)),i)}}}();var l;!function(){function t(){return[[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""]]}l=o.extend({forcePlainText:!0,cleanPastedHTML:!1,cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],window:window,document:document,targetBlank:!1,disableReturn:!1,parent:!0,init:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.base.subscribe("editablePaste",this.handlePaste.bind(this))},handlePaste:function(t,n){var i,o,s,a,r="",l="text/html",c="text/plain";if(this.window.clipboardData&&void 0===t.clipboardData&&(t.clipboardData=this.window.clipboardData,l="Text",c="Text"),t.clipboardData&&t.clipboardData.getData&&!t.defaultPrevented){if(t.preventDefault(),s=t.clipboardData.getData(l),a=t.clipboardData.getData(c),s||(s=a),this.cleanPastedHTML&&s)return this.cleanPaste(s);if(this.disableReturn||n.getAttribute("data-disable-return"))r=e.htmlEntities(a);else if(i=a.split(/[\r\n]+/g),i.length>1)for(o=0;o<i.length;o+=1)""!==i[o]&&(r+="<p>"+e.htmlEntities(i[o])+"</p>");else r=e.htmlEntities(i[0]);e.insertHTMLCommand(this.document,r)}},cleanPaste:function(n){var i,o,a,r=s.getSelectionElement(this.window),l=/<p|<br|<div/.test(n),c=t().concat(this.cleanReplacements||[]);for(i=0;i<c.length;i+=1)n=n.replace(c[i][0],c[i][1]);if(l){o=n.split("<br><br>"),this.pasteHTML("<p>"+o.join("</p><p>")+"</p>");try{this.document.execCommand("insertText",!1,"\n")}catch(h){}for(o=r.querySelectorAll("a,p,div,br"),i=0;i<o.length;i+=1)switch(a=o[i],a.innerHTML=a.innerHTML.replace(/\n/gi," "),a.tagName.toLowerCase()){case"a":this.targetBlank&&e.setTargetBlank(a);break;case"p":case"div":this.filterCommonBlocks(a);break;case"br":this.filterLineBreak(a)}}else this.pasteHTML(n)},pasteHTML:function(t,n){n=e.defaults({},n,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags});var i,o,s,a,r=this.document.createDocumentFragment();for(r.appendChild(this.document.createElement("body")),a=r.querySelector("body"),a.innerHTML=t,this.cleanupSpans(a),i=a.querySelectorAll("*"),s=0;s<i.length;s+=1)o=i[s],e.cleanupAttrs(o,n.cleanAttrs),e.cleanupTags(o,n.cleanTags);e.insertHTMLCommand(this.document,a.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(t){return t&&("p"===t.tagName.toLowerCase()||"div"===t.tagName.toLowerCase())},filterCommonBlocks:function(t){/^\s*$/.test(t.textContent)&&t.parentNode&&t.parentNode.removeChild(t)},filterLineBreak:function(t){this.isCommonBlock(t.previousElementSibling)?this.removeWithParent(t):!this.isCommonBlock(t.parentNode)||t.parentNode.firstChild!==t&&t.parentNode.lastChild!==t?t.parentNode&&1===t.parentNode.childElementCount&&""===t.parentNode.textContent&&this.removeWithParent(t):this.removeWithParent(t)},removeWithParent:function(t){t&&t.parentNode&&(t.parentNode.parentNode&&1===t.parentNode.childElementCount?t.parentNode.parentNode.removeChild(t.parentNode):t.parentNode.removeChild(t))},cleanupSpans:function(t){var n,i,o,s=t.querySelectorAll(".replace-with"),a=function(t){return t&&"#text"!==t.nodeName&&"false"===t.getAttribute("contenteditable")};for(n=0;n<s.length;n+=1)i=s[n],o=this.document.createElement(i.classList.contains("bold")?"b":"i"),i.classList.contains("bold")&&i.classList.contains("italic")?o.innerHTML="<i>"+i.innerHTML+"</i>":o.innerHTML=i.innerHTML,i.parentNode.replaceChild(o,i);for(s=t.querySelectorAll("span"),n=0;n<s.length;n+=1){if(i=s[n],e.traverseUp(i,a))return!1;e.unwrap(i,this.document)}}})}();var c;!function(){function t(){this.parent=!0,this.options={name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>'},this.name="anchor",this.hasForm=!0}t.prototype={formSaveLabel:"&#10003;",formCloseLabel:"&times;",handleClick:function(t){t.preventDefault(),t.stopPropagation();var n=s.getSelectedParentElement(e.getSelectionRange(this.base.options.ownerDocument));return n.tagName&&"a"===n.tagName.toLowerCase()?this.base.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var t=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.base.options.anchorInputPlaceholder,'">'];return t.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.base.options.buttonLabels?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),t.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.base.options.buttonLabels?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.base.options.anchorTarget&&t.push('<input type="checkbox" class="medium-editor-toolbar-anchor-target">',"<label>",this.base.options.anchorInputCheckboxLabel,"</label>"),this.base.options.anchorButton&&t.push('<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>Button</label>"),t.join("")},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(t){var e=this.getInput();this.base.saveSelection(),this.base.hideToolbarDefaultActions(),this.getForm().style.display="block",this.base.setToolbarPosition(),e.value=t||"",e.focus()},deactivate:function(){return this.form?(this.form.parentNode&&this.form.parentNode.removeChild(this.form),
void delete this.form):!1},getFormOpts:function(){var t=this.getForm().querySelector(".medium-editor-toolbar-anchor-target"),e=this.getForm().querySelector(".medium-editor-toolbar-anchor-button"),n={url:this.getInput().value};return this.base.options.checkLinkFormat&&(n.url=this.checkLinkFormat(n.url)),t&&t.checked?n.target="_blank":n.target="_self",e&&e.checked&&(n.buttonClass=this.base.options.anchorButtonClass),n},doFormSave:function(){var t=this.getFormOpts();this.completeFormSave(t)},completeFormSave:function(t){this.base.restoreSelection(),this.base.createLink(t),this.base.checkSelection()},checkLinkFormat:function(t){var e=/^(https?|ftps?|rtmpt?):\/\/|mailto:/;return(e.test(t)?"":"http://")+t},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(t){var e=t.querySelector(".medium-editor-toolbar-close"),n=t.querySelector(".medium-editor-toolbar-save"),i=t.querySelector(".medium-editor-toolbar-input");this.base.on(t,"click",this.handleFormClick.bind(this)),this.base.on(i,"keyup",this.handleTextboxKeyup.bind(this)),this.base.on(e,"click",this.handleCloseClick.bind(this)),this.base.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var t=this.base.options.ownerDocument,e=t.createElement("div");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-anchor-"+this.base.id,e.innerHTML=this.getTemplate(),this.attachFormEvents(e),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},handleTextboxKeyup:function(t){return t.keyCode===e.keyCode.ENTER?(t.preventDefault(),void this.doFormSave()):void(t.keyCode===e.keyCode.ESCAPE&&(t.preventDefault(),this.doFormCancel()))},handleFormClick:function(t){t.stopPropagation()},handleSaveClick:function(t){t.preventDefault(),this.doFormSave()},handleCloseClick:function(t){t.preventDefault(),this.doFormCancel()}},c=e.derives(r,t)}();var h;!function(){h=function(){this.parent=!0,this.name="anchor-preview"},h.prototype={previewValueSelector:"a",init:function(t){this.base=t,this.anchorPreview=this.createPreview(),this.base.options.elementsContainer.appendChild(this.anchorPreview),this.attachToEditables()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var t=this.base.options.ownerDocument.createElement("div");return t.id="medium-editor-anchor-preview-"+this.base.id,t.className="medium-editor-anchor-preview",t.innerHTML=this.getTemplate(),this.base.on(t,"click",this.handleClick.bind(this)),t},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},deactivate:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(t){return this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||t.getAttribute("data-disable-preview")?!0:(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=t.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=t.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=t,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(){var t,e,n=this.anchorPreview.offsetHeight,i=this.activeAnchor.getBoundingClientRect(),o=(i.left+i.right)/2;t=this.anchorPreview.offsetWidth/2,e=this.base.options.diffLeft-t,this.anchorPreview.style.top=Math.round(n+i.bottom-this.base.options.diffTop+this.base.options.contentWindow.pageYOffset-this.anchorPreview.offsetHeight)+"px",t>o?this.anchorPreview.style.left=e+t+"px":this.base.options.contentWindow.innerWidth-o<t?this.anchorPreview.style.left=this.base.options.contentWindow.innerWidth+e-t+"px":this.anchorPreview.style.left=e+o+"px"},attachToEditables:function(){this.base.subscribe("editableMouseover",this.handleEditableMouseover.bind(this))},handleClick:function(t){var e=this.base.getExtensionByName("anchor"),n=this.activeAnchor;e&&n&&(t.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){n&&(e.showForm(n.attributes.href.value),n=null)}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.base.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(t){var n=e.getClosestTag(t.target,"a");if(n){if(!/href=["']\S+["']/.test(n.outerHTML)||/href=["']#\S+["']/.test(n.outerHTML))return!0;if(this.base.toolbar&&this.base.toolbar.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==n&&this.detachPreviewHandlers(),this.anchorToPreview=n,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.base.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(t){t.relatedTarget&&/anchor-preview/.test(t.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;var t=(new Date).getTime()-this.lastOver;t>this.base.options.anchorPreviewHideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.base.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.base.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.base.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.base.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.base.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.base.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.base.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.base.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}}}();var u;!function(){function t(){this.parent=!0,this.options={name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>'},this.name="fontsize",this.hasForm=!0}t.prototype={handleClick:function(t){if(t.preventDefault(),t.stopPropagation(),!this.isDisplayed()){var e=this.base.options.ownerDocument.queryCommandValue("fontSize")+"";this.showForm(e)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(t){var e=this.getInput();this.base.saveSelection(),this.base.hideToolbarDefaultActions(),this.getForm().style.display="block",this.base.setToolbarPosition(),e.value=t||"",e.focus()},deactivate:function(){return this.form?(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form):!1},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var t=this.base.options.ownerDocument,e=t.createElement("div"),n=t.createElement("input"),i=t.createElement("a"),o=t.createElement("a");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-fontsize-"+this.base.id,this.base.on(e,"click",this.handleFormClick.bind(this)),n.setAttribute("type","range"),n.setAttribute("min","1"),n.setAttribute("max","7"),n.className="medium-editor-toolbar-input",e.appendChild(n),this.base.on(n,"change",this.handleSliderChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.base.options.buttonLabels?'<i class="fa fa-check"></i>':"&#10003;",e.appendChild(o),this.base.on(o,"click",this.handleSaveClick.bind(this),!0),i.setAttribute("href","#"),i.className="medium-editor-toobar-close",i.innerHTML="fontawesome"===this.base.options.buttonLabels?'<i class="fa fa-times"></i>':"&times;",e.appendChild(i),this.base.on(i,"click",this.handleCloseClick.bind(this)),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){s.getSelectedElements(this.base.options.ownerDocument).forEach(function(t){"FONT"===t.tagName&&t.hasAttribute("size")&&t.removeAttribute("size")})},handleSliderChange:function(){var t=this.getInput().value;"4"===t?this.clearFontSize():this.base.execAction("fontSize",{size:t})},handleFormClick:function(t){t.stopPropagation()},handleSaveClick:function(t){t.preventDefault(),this.doFormSave()},handleCloseClick:function(t){t.preventDefault(),this.doFormCancel()}},u=e.derives(r,t)}();var d;!function(){d=function(t){this.base=t,this.options=t.options,this.initThrottledMethods()},d.prototype={createToolbar:function(){var t=this.base.options.ownerDocument.createElement("div");return t.id="medium-editor-toolbar-"+this.base.id,t.className="medium-editor-toolbar",this.options.staticToolbar?t.className+=" static-toolbar":t.className+=" stalker-toolbar",t.appendChild(this.createToolbarButtons()),this.base.commands.forEach(function(e){e.hasForm&&t.appendChild(e.getForm())}),this.attachEventHandlers(),t},createToolbarButtons:function(){var t,n,i,o,s=this.base.options.ownerDocument.createElement("ul");return s.id="medium-editor-toolbar-actions"+this.base.id,s.className="medium-editor-toolbar-actions clearfix",s.style.display="block",this.base.options.buttons.forEach(function(i){o=this.base.getExtensionByName(i),"function"==typeof o.getButton&&(n=o.getButton(this.base),t=this.base.options.ownerDocument.createElement("li"),e.isElement(n)?t.appendChild(n):t.innerHTML=n,s.appendChild(t))}.bind(this)),i=s.querySelectorAll("button"),i.length>0&&(i[0].classList.add(this.options.firstButtonClass),i[i.length-1].classList.add(this.options.lastButtonClass)),s},deactivate:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=e.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.base.subscribe("blur",this.handleBlur.bind(this)),this.base.subscribe("focus",this.handleFocus.bind(this)),this.base.subscribe("editableClick",this.handleEditableClick.bind(this)),this.base.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.base.on(this.options.ownerDocument.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.options.staticToolbar&&this.options.stickyToolbar&&this.base.on(this.options.contentWindow,"scroll",this.handleWindowScroll.bind(this),!0),this.base.on(this.options.contentWindow,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(t){return t&&t.target&&e.isDescendant(this.getToolbarElement(),t.target)?!1:void this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),"function"==typeof this.options.onShowToolbar&&this.options.onShowToolbar())},hideToolbar:function(){this.isDisplayed()&&(this.base.commands.forEach(function(t){"function"==typeof t.onHide&&t.onHide()}),this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),"function"==typeof this.options.onHideToolbar&&this.options.onHideToolbar())},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.base.commands.forEach(function(t){t.hasForm&&t.isDisplayed()&&t.hideForm()})},multipleBlockElementsSelected:function(){var t=s.getSelectionHtml.call(this).replace(/<[\S]+><\/[\S]+>/gim,""),e=t.match(/<(p|h[1-6]|blockquote)[^>]*>/g);return!!e&&e.length>1},modifySelection:function(){var t=this.options.contentWindow.getSelection(),n=t.getRangeAt(0);if(this.options.standardizeSelectionStart&&n.startContainer.nodeValue&&n.startOffset===n.startContainer.nodeValue.length){var i=e.findAdjacentTextNodeWithContent(s.getSelectionElement(this.options.contentWindow),n.startContainer,this.options.ownerDocument);if(i){for(var o=0;0===i.nodeValue.substr(o,1).trim().length;)o+=1;var a=this.options.ownerDocument.createRange();a.setStart(i,o),a.setEnd(n.endContainer,n.endOffset),t.removeAllRanges(),t.addRange(a),n=a}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.getFocusedElement()||s.selectionInContentEditableFalse(this.options.contentWindow))return void this.hideToolbar();var t=s.getSelectionElement(this.options.contentWindow);if(!t||-1===this.base.elements.indexOf(t)||t.getAttribute("data-disable-toolbar"))return void this.hideToolbar();if(this.options.updateOnEmptySelection&&this.options.staticToolbar)return void this.showAndUpdateToolbar();""===this.options.contentWindow.getSelection().toString().trim()||this.options.allowMultiParagraphSelection===!1&&this.multipleBlockElementsSelected()?this.hideToolbar():this.showAndUpdateToolbar()}},getFocusedElement:function(){for(var t=0;t<this.base.elements.length;t+=1)if(this.base.elements[t].getAttribute("data-medium-focused"))return this.base.elements[t];return null},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.base.commands.forEach(function(t){"function"==typeof t.isActive&&"function"==typeof t.setInactive&&t.setInactive()}.bind(this)),this.checkActiveButtons()},checkActiveButtons:function(){var t,n=[],i=null,o=e.getSelectionRange(this.options.ownerDocument),a=function(e){"function"==typeof e.checkState?e.checkState(t):"function"==typeof e.isActive&&"function"==typeof e.isAlreadyApplied&&"function"==typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(t)&&e.setActive()};if(o)for(t=s.getSelectedParentElement(o),this.base.commands.forEach(function(t){return"function"==typeof t.queryCommandState&&(i=t.queryCommandState(),null!==i)?void(i&&"function"==typeof t.setActive&&t.setActive()):void n.push(t)});void 0!==t.tagName&&-1===e.parentElements.indexOf(t.tagName.toLowerCase)&&(n.forEach(a),-1===this.base.elements.indexOf(t));)t=t.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var t,e=this.getFocusedElement(),n=this.options.contentWindow.getSelection();return e?(this.options.staticToolbar?(this.showToolbar(),this.positionStaticToolbar(e)):n.isCollapsed||(this.showToolbar(),this.positionToolbar(n)),t=this.base.getExtensionByName("anchor-preview"),void(t&&"function"==typeof t.hidePreview&&t.hidePreview())):this},positionStaticToolbar:function(t){this.getToolbarElement().style.left="0";var e,n=this.options.ownerDocument.documentElement&&this.options.ownerDocument.documentElement.scrollTop||this.options.ownerDocument.body.scrollTop,i=this.options.contentWindow.innerWidth,o=this.getToolbarElement(),s=t.getBoundingClientRect(),a=s.top+n,r=s.left+s.width/2,l=o.offsetHeight,c=o.offsetWidth,h=c/2;this.options.stickyToolbar?n>a+t.offsetHeight-l?(o.style.top=a+t.offsetHeight-l+"px",o.classList.remove("sticky-toolbar")):n>a-l?(o.classList.add("sticky-toolbar"),o.style.top="0px"):(o.classList.remove("sticky-toolbar"),o.style.top=a-l+"px"):o.style.top=a-l+"px","left"===this.options.toolbarAlign?e=s.left:"center"===this.options.toolbarAlign?e=r-h:"right"===this.options.toolbarAlign&&(e=s.right-c),0>e?e=0:e+c>i&&(e=i-Math.ceil(c)-1),o.style.left=e+"px"},positionToolbar:function(t){this.getToolbarElement().style.left="0";var e=this.options.contentWindow.innerWidth,n=t.getRangeAt(0),i=n.getBoundingClientRect(),o=(i.left+i.right)/2,s=this.getToolbarElement(),a=s.offsetHeight,r=s.offsetWidth,l=r/2,c=50,h=this.options.diffLeft-l;i.top<c?(s.classList.add("medium-toolbar-arrow-over"),s.classList.remove("medium-toolbar-arrow-under"),s.style.top=c+i.bottom-this.options.diffTop+this.options.contentWindow.pageYOffset-a+"px"):(s.classList.add("medium-toolbar-arrow-under"),s.classList.remove("medium-toolbar-arrow-over"),s.style.top=i.top+this.options.diffTop+this.options.contentWindow.pageYOffset-a+"px"),l>o?s.style.left=h+l+"px":l>e-o?s.style.left=e+h-l+"px":s.style.left=h+o+"px"}}}();var p;!function(){p=function(t){this.base=t,this.initPlaceholders(),this.attachEventHandlers()},p.prototype={initPlaceholders:function(){this.base.elements.forEach(function(t){this.updatePlaceholder(t)},this)},showPlaceholder:function(t){t&&t.classList.add("medium-editor-placeholder")},hidePlaceholder:function(t){t&&t.classList.remove("medium-editor-placeholder")},updatePlaceholder:function(t){t.querySelector("img")||t.querySelector("blockquote")||""!==t.textContent.replace(/^\s+|\s+$/g,"")?this.hidePlaceholder(t):this.showPlaceholder(t)},attachEventHandlers:function(){this.base.subscribe("blur",this.handleExternalInteraction.bind(this)),this.base.subscribe("editableBlur",this.handleBlur.bind(this)),this.base.subscribe("editableClick",this.handleHidePlaceholderEvent.bind(this)),this.base.subscribe("editableKeypress",this.handleHidePlaceholderEvent.bind(this)),this.base.subscribe("editablePaste",this.handleHidePlaceholderEvent.bind(this))},handleHidePlaceholderEvent:function(t,e){this.hidePlaceholder(e)},handleBlur:function(t,e){this.updatePlaceholder(e)},handleExternalInteraction:function(){this.initPlaceholders()}}}();var f;return function(){f={paste:l}}(),function(){function l(t,n){if(this.options.disableReturn||n.getAttribute("data-disable-return"))t.preventDefault();else if(this.options.disableDoubleReturn||this.getAttribute("data-disable-double-return")){var i=e.getSelectionStart(this.options.ownerDocument);i&&""===i.textContent.trim()&&t.preventDefault()}}function m(t){if("ARTICLE"===t.srcElement.tagName)return t.preventDefault(),!1;var n=e.getSelectionStart(this.options.ownerDocument),i=n&&n.tagName.toLowerCase();"pre"===i&&(t.preventDefault(),e.insertHTMLCommand(this.options.ownerDocument,"    ")),e.isListItem(n)&&(t.preventDefault(),t.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}function b(t){var n,i,o,a=e.getSelectionStart(this.options.ownerDocument),r=a.tagName.toLowerCase(),l=/^(\s+|<br\/?>)?$/i,c=/h\d/i;(t.which===e.keyCode.BACKSPACE||t.which===e.keyCode.ENTER)&&a.previousElementSibling&&c.test(r)&&0===s.getCaretOffsets(a).left?t.which===e.keyCode.BACKSPACE&&l.test(a.previousElementSibling.innerHTML)?(a.previousElementSibling.parentNode.removeChild(a.previousElementSibling),t.preventDefault()):t.which===e.keyCode.ENTER&&(o=this.options.ownerDocument.createElement("p"),o.innerHTML="<br>",a.previousElementSibling.parentNode.insertBefore(o,a),t.preventDefault()):t.which===e.keyCode.DELETE&&a.nextElementSibling&&a.previousElementSibling&&!c.test(r)&&l.test(a.innerHTML)&&c.test(a.nextElementSibling.tagName)?(n=this.options.ownerDocument.createRange(),i=this.options.ownerDocument.getSelection(),n.setStart(a.nextElementSibling,0),n.collapse(!0),i.removeAllRanges(),i.addRange(n),a.previousElementSibling.parentNode.removeChild(a),t.preventDefault()):t.which!==e.keyCode.BACKSPACE||"li"!==r||!l.test(a.innerHTML)||a.previousElementSibling||a.parentElement.previousElementSibling||"li"!==a.nextElementSibling.tagName.toLowerCase()||(o=this.options.ownerDocument.createElement("p"),o.innerHTML="<br>",a.parentElement.parentElement.insertBefore(o,a.parentElement),n=this.options.ownerDocument.createRange(),i=this.options.ownerDocument.getSelection(),n.setStart(o,0),n.collapse(!0),i.removeAllRanges(),i.addRange(n),a.parentElement.removeChild(a),t.preventDefault())}function g(t){var e="medium-editor-dragover";t.preventDefault(),t.dataTransfer.dropEffect="copy","dragover"===t.type?t.target.classList.add(e):"dragleave"===t.type&&t.target.classList.remove(e)}function v(t){var n,i="medium-editor-dragover";t.preventDefault(),t.stopPropagation(),t.dataTransfer.files&&(n=Array.prototype.slice.call(t.dataTransfer.files,0),n.some(function(t){if(t.type.match("image")){var n,i;n=new FileReader,n.readAsDataURL(t),i="medium-img-"+ +new Date,e.insertHTMLCommand(this.options.ownerDocument,'<img class="medium-image-loading" id="'+i+'" />'),n.onload=function(){var t=this.options.ownerDocument.getElementById(i);t&&(t.removeAttribute("id"),t.removeAttribute("class"),t.src=n.result)}.bind(this)}}.bind(this))),t.target.classList.remove(i)}function w(t){var n,i=e.getSelectionStart(this.options.ownerDocument);i&&(i.getAttribute("data-medium-element")&&0===i.children.length&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),t.which!==e.keyCode.ENTER||e.isListItem(i)||(n=i.tagName.toLowerCase(),"a"===n?this.options.ownerDocument.execCommand("unlink",!1,null):t.shiftKey||/h\d/.test(n)||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function y(t){t||(t=[]),"string"==typeof t&&(t=this.options.ownerDocument.querySelectorAll(t)),e.isElement(t)&&(t=[t]);var n=Array.prototype.slice.apply(t);this.elements=[],n.forEach(function(t){"textarea"===t.tagName.toLowerCase()?this.elements.push(S.call(this,t)):this.elements.push(t)},this)}function E(t,e,n){return t.parent&&(t.base=n),"function"==typeof t.init&&t.init(n),t.name||(t.name=e),t}function C(){var t,e=!1;if(this.options.disableAnchorPreview)return!1;if(this.options.extensions["anchor-preview"])return!1;if(this.options.disableToolbar)return!1;for(t=0;t<this.elements.length;t+=1)if(!this.elements[t].getAttribute("data-disable-toolbar")){e=!0;break}return e}function S(t){var e=this.options.ownerDocument.createElement("div"),n=+new Date,i=["data-disable-editing","data-disable-toolbar","data-placeholder","data-disable-return","data-disable-double-return","data-disable-preview","spellcheck"];return e.className=t.className,e.id=n,e.innerHTML=t.value,e.setAttribute("medium-editor-textarea-id",n),i.forEach(function(n){t.hasAttribute(n)&&e.setAttribute(n,t.getAttribute(n))}),t.classList.add("medium-editor-hidden"),t.setAttribute("medium-editor-textarea-id",n),t.parentNode.insertBefore(e,t),e}function T(){this.elements.forEach(function(t){this.options.disableEditing||t.getAttribute("data-disable-editing")||(t.setAttribute("contentEditable",!0),t.setAttribute("spellcheck",this.options.spellcheck)),t.getAttribute("data-placeholder")||t.setAttribute("data-placeholder",this.options.placeholder),t.setAttribute("data-medium-element",!0),t.setAttribute("role","textbox"),t.setAttribute("aria-multiline",!0),t.hasAttribute("medium-editor-textarea-id")&&this.on(t,"input",function(t){var e=t.target,n=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');n&&(n.value=this.serialize()[e.id].value)}.bind(this))},this)}function A(){if(this.toolbar||this.options.disableToolbar)return!1;var t=this.elements.some(function(t){return!t.getAttribute("data-disable-toolbar")});t&&(this.toolbar=new d(this),this.options.elementsContainer.appendChild(this.toolbar.getToolbarElement()))}function D(){var t;if(this.subscribe("editableKeydownTab",m.bind(this)),this.subscribe("editableKeydownDelete",b.bind(this)),this.subscribe("editableKeydownEnter",b.bind(this)),this.options.disableReturn||this.options.disableDoubleReturn)this.subscribe("editableKeydownEnter",l.bind(this));else for(t=0;t<this.elements.length;t+=1)if(this.elements[t].getAttribute("data-disable-return")||this.elements[t].getAttribute("data-disable-double-return")){this.subscribe("editableKeydownEnter",l.bind(this));break}this.options.disableReturn||this.elements.forEach(function(t){t.getAttribute("data-disable-return")||this.on(t,"keyup",w.bind(this))},this),this.options.imageDragging&&(this.subscribe("editableDrag",g.bind(this)),this.subscribe("editableDrop",v.bind(this)))}function k(n){var i={forcePlainText:this.options.forcePlainText,cleanPastedHTML:this.options.cleanPastedHTML,disableReturn:this.options.disableReturn,targetBlank:this.options.targetBlank,window:this.options.contentWindow,document:this.options.ownerDocument};return new t.extensions.paste(e.extend({},n,i))}function N(){var t,e,i=this.options.buttons,o=this.options.extensions;this.commands=[],i.forEach(function(e){o[e]?(t=E(o[e],e,this),this.commands.push(t)):"anchor"===e?(t=E(new c,e,this),this.commands.push(t)):"fontsize"===e?(t=E(new u,e,this),this.commands.push(t)):n.hasOwnProperty(e)&&(t=new r(n[e],this),this.commands.push(t))},this);for(e in o)o.hasOwnProperty(e)&&-1===i.indexOf(e)&&(t=E(o[e],e,this),this.commands.push(t));this.options.extensions.paste||this.commands.push(E(k.call(this,this.options.paste),"paste",this)),C.call(this)&&this.commands.push(E(new h,"anchor-preview",this))}function L(t,n){n&&[["forcePlainText","paste.forcePlainText"],["cleanPastedHTML","paste.cleanPastedHTML"]].forEach(function(t){n.hasOwnProperty(t[0])&&void 0!==n[t[0]]&&e.deprecated(t[0],t[1],"v5.0.0")});var i=["paste"],o=e.extend({},n);return i.forEach(function(n){o[n]?o[n]=e.defaults({},o[n],t[n]):o[n]=t[n]}),e.defaults(o,t)}function x(t,n){var i,o=/^append-(.+)$/gi;return i=o.exec(t),i?e.execFormatBlock(this.options.ownerDocument,i[1]):"fontSize"===t?this.options.ownerDocument.execCommand("fontSize",!1,n.size):"createLink"===t?this.createLink(n):"image"===t?this.options.ownerDocument.execCommand("insertImage",!1,this.options.contentWindow.getSelection()):this.options.ownerDocument.execCommand(t,!1,null)}t.statics={ButtonsData:n,DefaultButton:r,AnchorExtension:c,FontSizeExtension:u,Toolbar:d,AnchorPreview:h},t.Extension=o,t.extensions=f,t.util=e,t.selection=s,t.prototype={defaults:i,init:function(t,e){var n=1;if(this.options=L.call(this,this.defaults,e),y.call(this,t),0!==this.elements.length){for(this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body);this.options.elementsContainer.querySelector("#medium-editor-toolbar-"+n);)n+=1;return this.id=n,this.setup()}},setup:function(){this.isActive||(this.events=new a(this),this.isActive=!0,T.call(this),N.call(this),A.call(this),D.call(this),this.options.disablePlaceholders||(this.placeholders=new p(this)))},destroy:function(){if(this.isActive){var t;for(this.isActive=!1,void 0!==this.toolbar&&(this.toolbar.deactivate(),delete this.toolbar),t=0;t<this.elements.length;t+=1)this.elements[t].removeAttribute("contentEditable"),this.elements[t].removeAttribute("spellcheck"),this.elements[t].removeAttribute("data-medium-element");this.commands.forEach(function(t){"function"==typeof t.deactivate&&t.deactivate()},this),this.events.detachAllDOMEvents(),this.events.detachAllCustomEvents()}},on:function(t,e,n,i){this.events.attachDOMEvent(t,e,n,i)},off:function(t,e,n,i){this.events.detachDOMEvent(t,e,n,i)},subscribe:function(t,e){this.events.attachCustomEvent(t,e)},unsubscribe:function(t,e){this.events.detachCustomEvent(t,e)},delay:function(t){var e=this;return setTimeout(function(){e.isActive&&t()},this.options.delay)},serialize:function(){var t,e,n={};for(t=0;t<this.elements.length;t+=1)e=""!==this.elements[t].id?this.elements[t].id:"element-"+t,n[e]={value:this.elements[t].innerHTML.trim()};return n},getExtensionByName:function(t){var e;return this.commands&&this.commands.length&&this.commands.some(function(n){return n.name===t?(e=n,!0):!1}),e},callExtensions:function(t){if(!(arguments.length<1)){var e,n,i=Array.prototype.slice.call(arguments,1);for(n in this.options.extensions)this.options.extensions.hasOwnProperty(n)&&(e=this.options.extensions[n],void 0!==e[t]&&e[t].apply(e,i));return this}},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){return this.toolbar&&this.toolbar.checkState(),this},queryCommandState:function(t){var e,n=/^full-(.+)$/gi,i=null;e=n.exec(t),e&&(t=e[1]);try{i=this.options.ownerDocument.queryCommandState(t)}catch(o){i=null}return i},execAction:function(t,n){var i,o,s=/^full-(.+)$/gi;return i=s.exec(t),i?(this.saveSelection(),this.selectAllContents(),o=x.call(this,i[1],n),this.restoreSelection()):o=x.call(this,t,n),("insertunorderedlist"===t||"insertorderedlist"===t)&&e.cleanListDOM(this.getSelectedParentElement()),this.checkSelection(),o},getSelectedParentElement:function(t){return void 0===t&&(t=this.options.contentWindow.getSelection().getRangeAt(0)),s.getSelectedParentElement(t)},hideToolbarDefaultActions:function(){return this.toolbar&&this.toolbar.hideToolbarDefaultActions(),this},setToolbarPosition:function(){this.toolbar&&this.toolbar.setToolbarPosition()},selectAllContents:function(){var t=s.getSelectionElement(this.options.contentWindow);if(t){for(;1===t.children.length;)t=t.children[0];this.selectElement(t)}},selectElement:function(t){s.selectNode(t,this.options.ownerDocument);var e=s.getSelectionElement(this.options.contentWindow);e&&this.events.focusElement(e)},exportSelection:function(){var t,n,i,o=null,s=this.options.contentWindow.getSelection(),a=-1;return s.rangeCount>0&&(t=s.getRangeAt(0),n=t.cloneRange(),this.elements.some(function(n,i){return n===t.startContainer||e.isDescendant(n,t.startContainer)?(a=i,!0):!1}),a>-1&&(n.selectNodeContents(this.elements[a]),n.setEnd(t.startContainer,t.startOffset),i=n.toString().length,o={start:i,end:i+t.toString().length,editableElementIndex:a})),null!==o&&0===o.editableElementIndex&&delete o.editableElementIndex,o},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(t){if(t){var e,n,i,o,s=void 0===t.editableElementIndex?0:t.editableElementIndex,a={editableElementIndex:s,start:t.start,end:t.end},r=this.elements[a.editableElementIndex],l=0,c=this.options.ownerDocument.createRange(),h=[r],u=!1,d=!1;for(c.setStart(r,0),c.collapse(!0),e=h.pop();!d&&e;){if(3===e.nodeType)o=l+e.length,
!u&&a.start>=l&&a.start<=o&&(c.setStart(e,a.start-l),u=!0),u&&a.end>=l&&a.end<=o&&(c.setEnd(e,a.end-l),d=!0),l=o;else for(n=e.childNodes.length-1;n>=0;)h.push(e.childNodes[n]),n-=1;d||(e=h.pop())}i=this.options.contentWindow.getSelection(),i.removeAllRanges(),i.addRange(c)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(t){var n,i;if(t.url&&t.url.trim().length>0&&(this.options.ownerDocument.execCommand("createLink",!1,t.url),(this.options.targetBlank||"_blank"===t.target)&&e.setTargetBlank(e.getSelectionStart(this.options.ownerDocument)),t.buttonClass&&e.addClassToAnchors(e.getSelectionStart(this.options.ownerDocument),t.buttonClass)),this.options.targetBlank||"_blank"===t.target||t.buttonClass)for(n=this.options.ownerDocument.createEvent("HTMLEvents"),n.initEvent("input",!0,!0,this.options.contentWindow),i=0;i<this.elements.length;i+=1)this.elements[i].dispatchEvent(n)},activate:function(){e.deprecatedMethod.call(this,"activate","setup",arguments,"v5.0.0")},deactivate:function(){e.deprecatedMethod.call(this,"deactivate","destroy",arguments,"v5.0.0")},cleanPaste:function(t){this.getExtensionByName("paste").cleanPaste(t)},pasteHTML:function(t,e){this.getExtensionByName("paste").pasteHTML(t,e)}}}(),t.version=function(t,e,n){return{major:parseInt(t,10),minor:parseInt(e,10),revision:parseInt(n,10),toString:function(){return[t,e,n].join(".")}}}.apply(this,{version:"4.7.1"}.version.split(".")),t}());